<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Live Interactive Dashboard</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f4f4; margin:0; padding:20px; }

.card { background:#fff; border-radius:12px; padding:20px; margin-bottom:20px; box-shadow:0 4px 12px rgba(0,0,0,0.1); position:relative; }
.kpi-icon { font-size:28px; }
.kpi { font-size:24px; font-weight:bold; cursor:default; }
.kpisub { font-size:14px; color:#666; }

.gamify-progress .progress-wrapper { position:relative; height:16px; border-radius:12px; overflow:hidden; background:#e0e0e0; margin-top:10px; }
.gamify-progress .progress-bar { height:100%; width:0; border-radius:12px; transition: width 1s ease; background-size: 200% 100%; animation: gradientMove 3s linear infinite; }

@keyframes gradientMove {
  0% { background-position: 0% 0; }
  100% { background-position: 100% 0; }
}

.progress-info { display:flex; align-items:center; gap:5px; margin-top:6px; font-size:14px; flex-wrap:wrap; }
.progress-pill { padding:2px 8px; border-radius:12px; font-weight:bold; color:#fff; white-space:nowrap; position:relative; cursor:default; }
.completed-pill { background:#10b981; }
.total-pill { background:#3b82f6; }

.progress-pill[data-tooltip]:hover::after,
.gamify-badge[data-tooltip]:hover::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.8);
  color: #fff;
  padding: 6px 10px;
  border-radius: 8px;
  white-space: nowrap;
  font-size:12px;
  opacity: 1;
  visibility: visible;
  pointer-events: none;
  z-index: 10;
}

.progress-pill[data-tooltip]:hover::before,
.gamify-badge[data-tooltip]:hover::before {
  content: '';
  position: absolute;
  bottom: 115%;
  left: 50%;
  transform: translateX(-50%);
  border-width: 6px;
  border-style: solid;
  border-color: rgba(0,0,0,0.8) transparent transparent transparent;
  opacity: 1;
  visibility: visible;
  z-index: 10;
}

.gamify-badges-container { display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; }
.gamify-badge { padding:8px 14px; border-radius:12px; color:#fff; font-weight:bold; box-shadow:0 4px 12px rgba(0,0,0,0.2); cursor:default; transition: transform 0.3s ease, box-shadow 0.3s ease; position:relative; }
.gamify-badge:hover { transform: scale(1.1); box-shadow:0 6px 18px rgba(0,0,0,0.35), 0 0 10px rgba(255,255,255,0.5); }

.milestone-1 { background:#cd7f32; } 
.milestone-5 { background:#c0c0c0; } 
.milestone-10 { background:#ffd700; } 
.milestone-25 { background:#9a22f6; } 
.milestone-50 { background:#00bfff; } 

/* Mini charts */
.mini-chart { width:100%; height:100px; margin-top:15px; }
</style>
</head>
<body>

<div class="card task-streak-card" title="Track your task completion streak">
  <div class="kpi-icon">üèÜ</div>
  <div class="kpi" id="kpi-streak">0</div>
  <div class="kpisub">Task Streak</div>

  <div id="gamify-progress" class="gamify-progress">
    <div class="progress-wrapper">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
    <div class="progress-info">
      <span class="progress-pill completed-pill" id="completed-pill" data-tooltip="Tasks you have completed so far">0</span>
      <span class="progress-text">of</span>
      <span class="progress-pill total-pill" id="total-pill" data-tooltip="Total tasks assigned">0</span>
      <span class="progress-text">tasks completed</span>
    </div>
  </div>

  <canvas id="mini-chart" class="mini-chart"></canvas>
</div>

<div class="card">
  <div class="gamify-badges-container" id="gamify-badges-container"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let data = {
  tasks: Array.from({length:16}, (_,i)=>({ID:i+1, Status:i<5?'done':'open'}))
};

const streakEl = document.getElementById("kpi-streak");
const completedPill = document.getElementById("completed-pill");
const totalPill = document.getElementById("total-pill");
const progressBar = document.getElementById("progress-bar");
const gamifyContainer = document.getElementById("gamify-badges-container");

let reachedMilestones = new Set();

// Chart.js setup
const ctx = document.getElementById('mini-chart').getContext('2d');
let miniChart = new Chart(ctx, {
    type:'bar',
    data: {
      labels: data.tasks.map(t=>t.ID),
      datasets:[{
        label:'Task Status',
        data: data.tasks.map(t=>t.Status==='done'?1:0),
        backgroundColor: data.tasks.map(t=>t.Status==='done'?'#10b981':'#3b82f6'),
        borderRadius: 4
      }]
    },
    options:{ plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true, max:1, ticks:{display:false}}}}
});

function renderDashboard() {
  const completed = data.tasks.filter(t=>t.Status==='done').length;
  const total = data.tasks.length;

  streakEl.textContent = completed;

  // Progress Pills
  completedPill.textContent = completed;
  totalPill.textContent = total;

  // Animated gradient progress bar
  const percentage = total ? (completed/total)*100 : 0;
  progressBar.style.width = percentage+"%";
  if(percentage<50) progressBar.style.background="linear-gradient(270deg,#f97316,#f59e0b)";
  else if(percentage<100) progressBar.style.background="linear-gradient(270deg,#3b82f6,#6366f1)";
  else progressBar.style.background="linear-gradient(270deg,#10b981,#22c55e)";

  // Milestone Badges
  const badgeMilestones = [1,5,10,25,50];
  gamifyContainer.innerHTML='';
  badgeMilestones.forEach(ms=>{
    if(completed>=ms){
      const badge = document.createElement("div");
      badge.className = "gamify-badge milestone-"+ms;
      badge.textContent = `üèÖ ${ms} tasks completed!`;
      badge.dataset.tooltip = `You've completed ${ms} tasks! Keep the streak going!`;
      gamifyContainer.appendChild(badge);
    }
  });

  // Update mini-chart
  miniChart.data.datasets[0].data = data.tasks.map(t=>t.Status==='done'?1:0);
  miniChart.data.datasets[0].backgroundColor = data.tasks.map(t=>t.Status==='done'?'#10b981':'#3b82f6');
  miniChart.update();
}

renderDashboard();

// Simulate live progress
setInterval(()=>{
  const openTasks = data.tasks.filter(t=>t.Status!=='done');
  if(openTasks.length>0) openTasks[Math.floor(Math.random()*openTasks.length)].Status='done';
  renderDashboard();
},4000);
</script>

</body>
</html>
